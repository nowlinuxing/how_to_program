readable_code
=============

# リーダブルなコード

## 抽象化・具体化レベルを揃える
* 既知から未知へ
  * Railsなら
      1. Controller#action
      2. Model#public_methods
      3. Model#private_methods
    とたどると
      1. 要求仕様
      2. 実装
      3. 実装詳細
    となっていくようにする
* エントリポイントに詳細なロジックを置かない
  * 前頭前野
    * まず「大きな脈略」を理解することが必要


## 規則を意識する
* 対義語
  * set / get
* パラレリズム
* 用語の統一


## 推測しやすくする
* 比喩
  * 現実の知識を流用
* 英語
* 「読者の期待通りの場所に期待通りのことを書く」 (数学文章作法 P68)
  * 驚き最小の法則
複数の情報を与える
  * どこかに気づけばたどり着ける
    * ロバストな作り
  * 他の経路と合わせることで検算できる
    * より深い安心感


## メソッド名は見出し
* コメントは最小限
  * できればないほうがいい
    * 当たり前のことは書かない
      * 重複したコード
      * 嘘コメントになる恐れ
      * 見ずらくなる
    * How でなく What を、手順ではなく目的を
    * コードで語れ
  * なぜそれをしなかったのかは書く
  * コメントをメソッド名にできないか考える
* マジックナンバーを使わない
  * 定数などで名前をつける
* ななめ読み耐性 (「分かりやすい文章」の技術)
　* 文章強度
    →推測しやすい
名前重要


## 名前重要
* "send"、"tmp"、"data"、"新しいフォルダ"
  * 何にでも使える
    →何に使っているか特定しにくい


## 整形
* レイアウト (「分かりやすい文章」の技術)
  * 見やすい文字配置
    * 改行 (1行1ステップ)
    * インデント
    * 名前
      * 狭いスコープ → 短い名前
      * 広いスコープ → 長い名前
  * 情報構造がわかる
  * 「かたまり」を区別する
    * 「メソッドの抽出」へ
  * 見出しをつける


## 明解に
* 二重否定は避ける
  * ドモルガンの法則を使って簡単に
* ネスト＝スタック
  * 深さ＝つらさ
    * 例外処理はガード節に
* 分ける
  * 「分ける」→「分かる」
    * マジカルナンバー７(±2)
    * チャンク化
  * 一時変数、メソッドを減らす
    * マジカルナンバー７(±2)
    →スコープを狭くできる→短い名前
* シンプルに
  * 将来こういう使い方をする、かもという先行投資
    →現在そのような使い方をしていないのであれば削除する
      * クラス/メソッド/モジュール/インターフェース
        * 部品、結合部分が減る
          →複雑度が下がる
    * 必要になったときに実装する
      * 自動テストによるデグレ防止


## 郷に入っては郷に従え
* コミュニティでの慣習的な表現
  * 複数の優秀な人によって、長期間、様々なコンテキストで検討され、磨かれ、選択されてきたエキス
    →ベストプラクティス
      * 試行錯誤が減る
      * もっといいやり方があるのではないか、と悩むことが減る
* 言語の標準ライブラリ、フレームワーク、定番の外部ライブラリを知る
  * 詳しい人にレビューしてもらう
  * 公開されているソースコードを読む


## 抽象度を上げ過ぎない
* 抽象的なことは把握しにくい
* 人類には早すぎるコード
  * 基底クラス→中間クラス1→中間クラス2→クラス→HAML→Knockout＋CoffeeScript
    ＋メタプログラミング
  * 難易度が高い
    * 手を入れられる人、レビュワーが限られる
    * 要員の確保によるスケールが困難
* 上げる場合は使用法、例を併記


## 嫌な臭い
* テストは通るが、パッと見て意味がとれない
  * 可読性に難あり、バグが入り込む隙になる


## 自然言語力を鍛えよう！
* センス大事
  * 語彙
    * 複数の候補
    * 表現の解像度を上げる
* 英語
  * コードに効く英語 ～正しく読めて“伝わる”クラス／メソッド名～ (WEB+DB PRESS Vol.74)

## 意図を込める
* if文 : 優先順位があるもの
  * unless文 : 正で*あって欲しい*がそうでない場合
* case文 : 優先順位がないもの


## コードは誰のもの
* コンピュータ？
  * 論理的に正しければ正しく動く
* 書いた人？
  * 過去の自分は他人
初めてそのコードを読む人のためのもの
  * コードはインターフェース
    * Write your own DSL
    * コードのバリアフリー化


## 参考文献

* プログラミング作法
* リーダブルコード
* 記憶力を強くする
* 「分かりやすい文章」の技術
* 相手に「伝わる」話し方
* 数学文章作法 基礎編
* リファクタリング:Rubyエディション
